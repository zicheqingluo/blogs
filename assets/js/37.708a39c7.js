(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{486:function(a,s,t){"use strict";t.r(s);var n=t(1),e=Object(n.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"运行环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#运行环境"}},[a._v("#")]),a._v(" 运行环境")]),a._v(" "),s("h4",{attrs:{id:"环境要求"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#环境要求"}},[a._v("#")]),a._v(" "),s("strong",[a._v("环境要求")])]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 首先，确定你的机器安装了 Python 3.8 及以上版本")]),a._v("\n$ python "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--version")]),a._v("\nPython "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3.8")]),a._v(".13\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[a._v("建议在linux上运行，windows会出现比较多的错误，本次在windows的ubuntu  wsl子系统运行。")]),a._v(" "),s("p",[a._v("需要注意，WSL子系统版本需要是2。")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("在CMD执行命令查看WSL子系统版本，如果不是2或为空则为1需要升级\n>wsl -l -v\n  NAME      STATE           VERSION\n* Ubuntu    Running         2\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("p",[a._v("升级请参考WSL文档。")]),a._v(" "),s("h3",{attrs:{id:"显卡环境"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#显卡环境"}},[a._v("#")]),a._v(" 显卡环境")]),a._v(" "),s("p",[a._v("参考"),s("a",{attrs:{href:"https://www.yangxiaokang.com/article/llm/NVIDIA.html",target:"_blank",rel:"nofollow noopener noreferrer"}},[a._v("大模型N卡环境配置"),s("OutboundLink")],1),a._v("安装显卡驱动、CUDA Toolkit 、cuDNN")]),a._v(" "),s("h3",{attrs:{id:"安装pytorch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装pytorch"}},[a._v("#")]),a._v(" 安装pytorch")]),a._v(" "),s("p",[a._v("python参考"),s("a",{attrs:{href:"https://www.yangxiaokang.com/article/llm/pytorch-install.html",target:"_blank",rel:"nofollow noopener noreferrer"}},[a._v("pytorch安装"),s("OutboundLink")],1)]),a._v(" "),s("h2",{attrs:{id:"项目运行"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目运行"}},[a._v("#")]),a._v(" 项目运行")]),a._v(" "),s("h3",{attrs:{id:"chatglm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#chatglm"}},[a._v("#")]),a._v(" ChatGLM")]),a._v(" "),s("p",[a._v("只需要需要下载"),s("a",{attrs:{href:"https://huggingface.co/THUDM/chatglm-6b",target:"_blank",rel:"nofollow noopener noreferrer"}},[a._v("模型实现和参数"),s("OutboundLink")],1),a._v("，详细见"),s("a",{attrs:{href:"https://www.yangxiaokang.com/article/llm/chatglm6b.html#%E9%85%8D%E7%BD%AE",target:"_blank",rel:"nofollow noopener noreferrer"}},[a._v("chatGLM"),s("OutboundLink")],1),a._v("。")]),a._v(" "),s("h3",{attrs:{id:"langchain-chatglm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#langchain-chatglm"}},[a._v("#")]),a._v(" langchain-ChatGLM")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v(" 拉取仓库\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("git")]),a._v(" clone https://github.com/imClumsyPanda/langchain-ChatGLM.git\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 进入目录")]),a._v("\n$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" langchain-ChatGLM\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 项目中 pdf 加载由先前的 detectron2 替换为使用 paddleocr，如果之前有安装过 detectron2 需要先完成卸载避免引发 tools 冲突")]),a._v("\n$ pip uninstall detectron2\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 检查paddleocr依赖，linux环境下paddleocr依赖libX11，libXext")]),a._v("\n$ yum "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" libX11 libXext "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#以上包在ubuntu上替换为")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sudo")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" libxext6 libX11-dev "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 安装依赖")]),a._v("\n$ pip "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" requirements.txt\n$ "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("apt-get")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("install")]),a._v(" ffmpeg libsm6 libxext6  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v("\n\n\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 验证paddleocr是否成功，首次运行会下载约18M模型到~/.paddleocr")]),a._v("\n$ python loader/image_loader.py\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br")])]),s("h3",{attrs:{id:"配置修改"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置修改"}},[a._v("#")]),a._v(" 配置修改")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('vim configs/model_config.py\n\n# embedding模型使用了text2vec，建议提前下载到本地\n# embedding_model_dict里面对应的text2vec的值就可以改为绝对路径地址\nembedding_model_dict = {\n    "text2vec": "/data/rd/llm/huggingface.co/text2vec-large-chinese",\n}\nEMBEDDING_MODEL = "text2vec"  # 指定embedding模型\n# llm配置也是同样思路，将模型实现下载到本地，llm_model_dict里面对应的模型地址改为绝对路径\nLLM_MODEL = "chatglm2-6b" 如chatglm2-6b\n\n#  文本分句长度按需修改，100大概是50多个汉字，50-75个单词\n# 尽量每句话不要太长\nSENTENCE_SIZE = 100\n# 热度我设置了800，按需测试，我这调小了没什么高质量回答\n# VECTOR_SEARCH_SCORE_THRESHOLD = 800\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br")])]),s("h3",{attrs:{id:"启动项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#启动项目"}},[a._v("#")]),a._v(" 启动项目")]),a._v(" "),s("p",[a._v("可以参考docs下的StartOption.md")]),a._v(" "),s("p",[s("code",[a._v("python webui.py --model chatglm2-6b --no-remote-model")])]),a._v(" "),s("h3",{attrs:{id:"错误处理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#错误处理"}},[a._v("#")]),a._v(" 错误处理")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("ImportError: libGL.so.1: cannot open shared object file: No such file or directory\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("解决方法：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("sudo apt-get install ffmpeg libsm6 libxext6  -y\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("错误：nvidia-smi 无法找到gpu")]),a._v(" "),s("p",[a._v("解决方法：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("dpkg list |grep nvidia-utils \napt-get remove nvidia-utils*\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h2",{attrs:{id:"参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[a._v("#")]),a._v(" 参考")]),a._v(" "),s("ul",[s("li",[a._v("[1]  "),s("a",{attrs:{href:"https://zhuanlan.zhihu.com/p/224753478",target:"_blank",rel:"nofollow noopener noreferrer"}},[a._v("windows WSL子系统升级"),s("OutboundLink")],1)]),a._v(" "),s("li",[a._v("[2]  "),s("a",{attrs:{href:"https://www.bilibili.com/read/cv14608547",target:"_blank",rel:"nofollow noopener noreferrer"}},[a._v("WSL子系统安装英伟达显卡相关驱动"),s("OutboundLink")],1)]),a._v(" "),s("li",[a._v("[3]  "),s("a",{attrs:{href:"https://www.jianshu.com/p/be669d9359e2",target:"_blank",rel:"nofollow noopener noreferrer"}},[a._v("WSL子系统安装英伟达显卡驱动相关流程"),s("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);